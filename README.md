# 在线拍卖系统 (Online Auction System)

基于 Flask + Socket.IO + MySQL 构建的实时在线拍卖平台。支持实时竞价、即时通讯、订单支付模拟、实名认证、钱包管理及完善的后台管理功能。

## ✨ 主要功能

*   **实时竞价**：基于 WebSocket 的毫秒级报价同步，支持防狙击机制（最后3分钟出价自动延时）及防连续出价。
*   **用户体系与角色**：
    *   **实名认证**：买家和卖家需绑定真实姓名和身份证号（仅做格式校验），未认证用户受限。
    *   **管理员**：拥有独立的后台管理看板（支持分标签页管理：待审核、进行中、申诉处理、历史记录、实名信息查看），可处理商品申诉、管理用户。
    *   **卖家**：发布拍品（支持 Decimal 高精度定价、商品分类选择）、管理草稿、查看销售记录、处理物流、对被驳回商品发起申诉。
    *   **买家**：浏览搜索（支持按分类筛选、按价格/时间排序）、参与竞拍、收藏商品、中标支付、即时通讯。
*   **钱包与资金系统**：
    *   **余额充值**：支持模拟微信/支付宝扫码充值（生成二维码）。
    *   **余额提现**：支持将账户余额提现到微信、支付宝或银行卡（模拟扣款，不存储敏感账号信息）。
    *   **保证金机制**：竞拍成功后资金暂时冻结，确认收货后解冻并划转给卖家。
    *   **流水记录**：完整的资金变动明细（充值、提现、支付、退款、违约扣除）。
*   **即时通讯 (IM)**：
    *   买卖双方可针对具体商品进行私信沟通。
    *   **消息分组**：买家/卖家的交易对话与系统管理员通知分标签页显示。
    *   **未读提醒**：支持红点气泡显示未读消息数量 (99+)。
*   **申诉与客服**：卖家可针对被驳回的商品提交申诉，管理员后台处理。
*   **订单与物流**：
    *   订单支付、发货（录入物流单号）、收货确认（支持超时自动确认）。
    *   支付超时惩罚机制。
*   **交互体验**：
    *   **个人主页**：展示用户头像、简介、认证状态、邮箱及信用等级。
    *   **商品收藏**：关注感兴趣的拍卖品。
    *   **全站通知**：实时 Toast 通知的关键事件（中标、审核通过等）。

## 🛠️ 环境准备

1.  **Python 3.8+**
2.  **MySQL 8.0+**
3.  **浏览器**：推荐 Chrome/Edge (支持现代 WebSocket)

## 🚀 安装部署指南

### 1. 数据库配置
在 MySQL 中创建一个空的数据库，命名为 `Auction`：
```sql
CREATE DATABASE Auction DEFAULT CHARACTER SET utf8mb4;
```
*注：首次启动或重置时，系统会自动应用 schema.sql 创建完整表结构（包含实名认证、物流扩展字段等）。*

### 2. 项目配置
打开 `app.py`，确认数据库连接配置（根据你的实际 MySQL 账号密码修改）：
```python
# app.py
app.config['SQLALCHEMY_DATABASE_URI'] = 'mysql+pymysql://root:123456@localhost/Auction'
```

### 3. 环境安装
```bash
# 创建虚拟环境 (可选但推荐)
python -m venv venv
# 激活环境 (Windows)
.\venv\Scripts\activate

# 安装依赖项 (包含 Flask, Flask-SocketIO, PyMySQL, qrcode 等)
pip install -r requirements.txt
pip install qrcode[pil]
```

### 4. 启动系统
```bash
python app.py
```
终端显示 `Running on http://0.0.0.0:5000` 即表示启动成功。

*首次启动时，系统会自动创建一个默认管理员账号：*
*   用户名：`admin`
*   密码：`123`

## 📖 使用手册

### 访问
打开浏览器访问：`http://127.0.0.1:5000`

### 典型流程
1.  **注册与实名**：
    *   注册账号后，需前往“个人中心”完成实名认证才能参与核心交易。
2.  **发布与审核**：
    *   卖家发布商品 -> 管理员后台审核 -> 商品上架 (Active)。
3.  **竞拍**：
    *   买家出价 -> 实时更新最高价 -> 结束时判定得主。
4.  **履约流程**：
    *   中标(Ended) -> 买家支付 -> 卖家发货(填写运单) -> 买家收货 -> 资金解冻划拨卖家。

## 📞 联系与开发
本项目仅供计算机网络课程设计/学习交流使用，不涉及真实资金交易。

## ⚠️ 注意事项
*   本系统支付功能仅为逻辑模拟，生成的二维码不产生实际扣款。
*   实名认证信息仅用于演示，不进行真实 API 校验。
